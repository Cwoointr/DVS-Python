VERSION 4.00Begin VB.Form Form1    Caption         =   "DC120SDK Interface Layer for VisualBasic Sample Application"   ClientHeight    =   2910   ClientLeft      =   2460   ClientTop       =   2565   ClientWidth     =   7545   BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}       Name            =   "MS Sans Serif"      Size            =   8.25      Charset         =   0      Weight          =   400      Underline       =   0   'False      Italic          =   0   'False      Strikethrough   =   0   'False   EndProperty   Height          =   3600   Icon            =   "Form1.frx":0000   Left            =   2400   LinkTopic       =   "Form1"   ScaleHeight     =   2910   ScaleWidth      =   7545   Top             =   1935   Width           =   7665   Begin VB.TextBox Text7       Height          =   285      Left            =   4080      TabIndex        =   15      Text            =   "Text1"      Top             =   960      Width           =   855   End   Begin VB.TextBox Text6       Height          =   285      Left            =   4080      TabIndex        =   13      Text            =   "Text1"      Top             =   600      Width           =   855   End   Begin VB.TextBox Text5       Height          =   285      Left            =   4080      TabIndex        =   11      Text            =   "Text1"      Top             =   240      Width           =   855   End   Begin VB.TextBox Text4       Height          =   285      Left            =   1560      TabIndex        =   9      Text            =   "Text1"      Top             =   1320      Width           =   855   End   Begin VB.TextBox Text3       Height          =   285      Left            =   1560      TabIndex        =   7      Text            =   "Text1"      Top             =   600      Width           =   855   End   Begin VB.TextBox Text2       Height          =   285      Left            =   1560      TabIndex        =   5      Text            =   "Text1"      Top             =   240      Width           =   855   End   Begin VB.CommandButton Command99       Caption         =   "End"      Height          =   375      Left            =   5520      TabIndex        =   4      Top             =   240      Width           =   1695   End   Begin VB.CheckBox Check1       Caption         =   "Thumb Flag"      Height          =   195      Left            =   360      TabIndex        =   3      Top             =   1800      Value           =   1  '¡™Ø∏      Width           =   1215   End   Begin VB.TextBox Text1       Height          =   285      Left            =   1560      TabIndex        =   2      Text            =   "Text1"      Top             =   960      Width           =   855   End   Begin VB.Label Label1       AutoSize        =   -1  'True      Caption         =   "ToAlbumNum :"      Height          =   195      Index           =   6      Left            =   2880      TabIndex        =   16      Top             =   960      Width           =   1095   End   Begin VB.Label Label1       AutoSize        =   -1  'True      Caption         =   "FromAlbumNum :"      Height          =   195      Index           =   5      Left            =   2880      TabIndex        =   14      Top             =   600      Width           =   1200   End   Begin VB.Label Label1       AutoSize        =   -1  'True      Caption         =   "ActiveAlbum :"      Height          =   195      Index           =   4      Left            =   2880      TabIndex        =   12      Top             =   240      Width           =   1095   End   Begin VB.Label Label1       AutoSize        =   -1  'True      Caption         =   "CompLevel :"      Height          =   195      Index           =   3      Left            =   360      TabIndex        =   10      Top             =   1320      Width           =   1005   End   Begin VB.Label Label1       AutoSize        =   -1  'True      Caption         =   "AlbumNum :"      Height          =   195      Index           =   2      Left            =   360      TabIndex        =   8      Top             =   600      Width           =   855   End   Begin VB.Label Label1       AutoSize        =   -1  'True      Caption         =   "CamMemType :"      Height          =   195      Index           =   0      Left            =   360      TabIndex        =   6      Top             =   240      Width           =   1230   End   Begin VB.Label Label1       AutoSize        =   -1  'True      Caption         =   "PictNum :"      Height          =   195      Index           =   1      Left            =   360      TabIndex        =   1      Top             =   960      Width           =   735   End   Begin ComctlLib.StatusBar StatusBar1       Align           =   2  'â∫Ç…çáÇÌÇπÇÈ      Height          =   375      Left            =   0      TabIndex        =   0      Top             =   2535      Width           =   7545      _ExtentX        =   13309      _ExtentY        =   661      Style           =   1      SimpleText      =   ""      _Version        =   327680      BeginProperty Panels {0713E89E-850A-101B-AFC0-4210102A8DA7}          NumPanels       =   1         BeginProperty Panel1 {0713E89F-850A-101B-AFC0-4210102A8DA7}             Object.Width           =   5292            MinWidth        =   5292            TextSave        =   ""            Key             =   ""            Object.Tag             =   ""         EndProperty      EndProperty      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851}          Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"         Size            =   9         Charset         =   128         Weight          =   400         Underline       =   0   'False         Italic          =   0   'False         Strikethrough   =   0   'False      EndProperty      MouseIcon       =   "Form1.frx":0442   End   Begin MSComDlg.CommonDialog CommonDialog1       Left            =   1920      Top             =   1680      _ExtentX        =   847      _ExtentY        =   847      _Version        =   327680   End   Begin VB.Menu Menu1       Caption         =   "&Initialization"      Begin VB.Menu Menu11          Caption         =   "DCOpenDriver"      End      Begin VB.Menu Menu12          Caption         =   "DCCloseDriver"      End      Begin VB.Menu Menu13          Caption         =   "DCOpenCamera"      End      Begin VB.Menu Menu14          Caption         =   "DCCloseCamera"      End   End   Begin VB.Menu Menu2       Caption         =   "&Control"      Begin VB.Menu Menu21          Caption         =   "DCGetStatus"      End      Begin VB.Menu Menu22          Caption         =   "DCGetConfig"      End      Begin VB.Menu Menu23          Caption         =   "DCSetConfig"      End      Begin VB.Menu Menu24          Caption         =   "DCResetCamera"      End   End   Begin VB.Menu Menu3       Caption         =   "&Processing"      Begin VB.Menu Menu31          Caption         =   "DCGetImageProcessing"      End      Begin VB.Menu Menu32          Caption         =   "DCSetImageProcessing"      End      Begin VB.Menu Menu_DCGetOutputWindow          Caption         =   "DCGetOutputWindow"      End      Begin VB.Menu Menu_DCSetOutputWindow          Caption         =   "DCSetOutputWindow"      End   End   Begin VB.Menu Menu4       Caption         =   "&Management"      Begin VB.Menu Menu41          Caption         =   "DCTakePicture"      End      Begin VB.Menu Menu42          Caption         =   "DCDeletePicture"      End      Begin VB.Menu Menu43          Caption         =   "DCCopyMemToCard"      End   End   Begin VB.Menu Menu5       Caption         =   "&Retrieval"      Begin VB.Menu Menu51          Caption         =   "DCGetCameraPictInfo"      End      Begin VB.Menu Menu52          Caption         =   "DCGetNativeCameraType"      End      Begin VB.Menu Menu53          Caption         =   "DCGetNativePictInfo"      End      Begin VB.Menu Menu54          Caption         =   "DCGetCameraPicture"      End      Begin VB.Menu Menu55          Caption         =   "DCGetNativePicture"      End      Begin VB.Menu Menu56          Caption         =   "DCProcNativePicture"      End      Begin VB.Menu Menu_DCGetCameraPictureAsJPEG          Caption         =   "DCGetCameraPictureAsJPEG"      End      Begin VB.Menu Menu_DCProcNativePictureAsJPEG          Caption         =   "DCProcNativePictureAsJPEG"      End   End   Begin VB.Menu Menu_Preview       Caption         =   "Pre&view"      Begin VB.Menu Menu_DCPreviewGetInfo          Caption         =   "DCPreviewGetInfo"      End      Begin VB.Menu Menu_DCPreviewGetPicture          Caption         =   "DCPreviewGetPicture"      End      Begin VB.Menu Menu_DCPreviewStore          Caption         =   "DCPreviewStore"      End      Begin VB.Menu Menu_DCPreviewErase          Caption         =   "DCPreviewErase"      End   End   Begin VB.Menu Menu_Album       Caption         =   "&Album"      Begin VB.Menu Menu_DCAlbumGetAvailable          Caption         =   "DCAlbumGetAvailable"      End      Begin VB.Menu Menu_DCAlbumSetAvailable          Caption         =   "DCAlbumSetAvailable"      End      Begin VB.Menu Menu_DCAlbumSetActive          Caption         =   "DCAlbumSetActive"      End      Begin VB.Menu Menu_DCAlbumGetAllName          Caption         =   "DCAlbumGetAllName"      End      Begin VB.Menu Menu_DCAlbumErase          Caption         =   "DCAlbumErase"      End      Begin VB.Menu Menu_DCAlbumChangeName          Caption         =   "DCAlbumChangeName"      End      Begin VB.Menu Menu_DCAlbumMoveImage          Caption         =   "DCAlbumMoveImage"      End      Begin VB.Menu Menu_DCAlbumGetPictureName          Caption         =   "DCAlbumGetPictureName"      End   EndEndAttribute VB_Name = "Form1"Attribute VB_Creatable = FalseAttribute VB_Exposed = False''   DC40/50/120SDK Interface Layer for VisualBasic Test Application'       Copyright Eastman Kodak Company 1997.  All Rights Reserved.''       File Name  : Form1.frm'       Version    : 1.03'       Date       : Jun. 3, 1997 (Tue)'       Programmer : Futoshi Kitayama'Option ExplicitDim TIFFEPSize As LongDim TIFFEPBuf() As BytePrivate Const OF_READ = &H0Private Const OF_WRITE = &H1Private Declare Function lopen Lib "Kernel32" Alias "_lopen" _    (ByVal lpPathName As String, ByVal iReadWrite As Integer) As LongPrivate Declare Function lcreat Lib "Kernel32" Alias "_lcreat" _    (ByVal lpPathName As String, ByVal flag As Integer) As LongPrivate Declare Function lclose Lib "Kernel32" Alias "_lclose" _    (ByVal hfile As Long) As LongPrivate Declare Function hread Lib "Kernel32" Alias "_hread" _    (ByVal hfile As Long, Buffer As Any, ByVal n As Long) As LongPrivate Declare Function hwrite Lib "Kernel32" Alias "_hwrite" _    (ByVal hfile As Long, Buffer As Any, ByVal n As Long) As LongPrivate Sub Command17_Click()    Dim Ret As Integer    Dim CameraType As Long    Dim TIFFEPBuf() As Byte    Dim TIFFEPSize As Long    Dim TIFFEPFileName As String    Dim FileNum As Integer        CommonDialog1.filename = ""    CommonDialog1.Filter = "DC40/50 Pictures (*.kdc)|*.kdc|All Files (*.*)|*.*"    CommonDialog1.ShowOpen        If CommonDialog1.filename = "" Then        Exit Sub    Else        TIFFEPFileName = CommonDialog1.filename    End If           FileNum = FreeFile    Open TIFFEPFileName For Binary Access Read As FileNum    TIFFEPSize = LOF(FileNum)        If TIFFEPSize = 0 Then        StatusBar1.SimpleText = "DCNativePictInfo:FileNotFound"        Close FileNum        Kill TIFFEPFileName        Exit Sub    Else        ReDim TIFFEPBuf(TIFFEPSize)        Get FileNum, , TIFFEPBuf        Close FileNum    End If        Ret = DCGetNativeCameraType(CameraData, TIFFEPSize, TIFFEPBuf(0), CameraType)    StatusBar1.SimpleText = "GetNativeCameraType:" & DCMakeErrorMessage(Ret)        Ret = MsgBox("CameraType =" & Str(CameraType), vbInformation, "DCGetNativeCameraType")End SubPrivate Sub Command8_Click()        Dim JPEGFileNum As Integer, JPEGSize As Long, CompLevel As Long    Dim KDCFileNum As Integer, KDCFileLen As Long, KDCFileSize As Long    Dim Ret As Integer    Dim OutputBuffer() As Byte    Dim KDCFileName As String, JPEGFileName As String        CommonDialog1.filename = ""    CommonDialog1.Filter = "DC40/50 Pictures (*.kdc)|*.kdc|All Files (*.*)|*.*"    CommonDialog1.ShowOpen    If CommonDialog1.filename = "" Then        Exit Sub    Else        KDCFileName = CommonDialog1.filename    End If        CommonDialog1.filename = ""    CommonDialog1.Filter = "JPEG Pictures (*.jpg)|*.jpg|All Files (*.*)|*.*"    CommonDialog1.ShowSave    JPEGFileName = CommonDialog1.filename    If CommonDialog1.filename = "" Then        Exit Sub    Else        JPEGFileName = CommonDialog1.filename    End If    '    Ret = DCConvertFileToJPEG(CameraData, CompLevel, KDCFileName, JPEGFileName)    StatusBar1.SimpleText = "DCConvertFileToJPEG:" & DCMakeErrorMessage(Ret)End SubPrivate Sub Command9_Click()    Dim Ret As Integer        Ret = DCResetCamera(CameraData)    StatusBar1.SimpleText = "DCResetCamera:" & DCMakeErrorMessage(Ret)End SubPrivate Sub Command99_Click()    Dim Ret As Integer        Ret = DCCloseCamera(CameraData)    Ret = DCCloseDriver(CameraData.Driver)    EndEnd SubPrivate Sub DCCloseCamera_Click()End SubPrivate Sub DCGetStatusBtn_Click()End SubPrivate Sub DCOpenDriverBtn_Click()End SubPrivate Sub Form_Load()        CameraData.PortNum = DCPortNum1    CameraData.CamType = DC120    CameraData.SpecificCamType = DC120    CameraData.BitRate = DCBitRate115200    CameraData.Driver.CamType = CameraData.CamType'+b1c1 changed'    CameraData.Driver.GenericCameraType = CameraData.CamType    CameraData.Driver.SpecificCamType = CameraData.CamType'-b1c1 changed    CameraData.Driver.DriverOpenFlag = False    CameraData.Driver.CameraOpenFlag = False    CameraData.Driver.ROMModeFlag = False        CamMemType = DCCameraMemory    AlbumNum = -1    PictNum = 1    CompLevel = DCJPEGMediumQuality    ActiveAlbum = 1    FromAlbumNum = 1    ToAlbumNum = 1        Text1.Text = PictNum    Text2.Text = CamMemType    Text3.Text = AlbumNum    Text4.Text = CompLevel    Text5.Text = ActiveAlbum    Text6.Text = FromAlbumNum    Text7.Text = FromAlbumNum         Check1.Value = 1    End SubPrivate Sub Menu_DCAlbumChangeName_Click()    Form1.StatusBar1.SimpleText = ""    Form1.Refresh        DCAlbumChangeNameDlg.Text1 = ""        DCAlbumChangeNameDlg.ShowEnd SubPrivate Sub Menu_DCAlbumErase_Click()    Dim Ret As Integer    CamMemType = Val(Text2.Text)    AlbumNum = Val(Text3.Text)        Form1.StatusBar1.SimpleText = "Now Calling DCAlbumErase..."    Form1.Refresh        Ret = DCAlbumErase(CameraData, CamMemType, AlbumNum)    StatusBar1.SimpleText = "DCAlbumErase:" & DCMakeErrorMessage(Ret)End SubPrivate Sub Menu_DCAlbumGetAllName_Click()    Dim Cnt As Integer    Dim Cnt2 As Integer    Dim NumOfAlbums As Integer    Dim TempStr As String    Dim Ret As Integer    StatusBar1.SimpleText = "Now Calling DCGetStatus..."    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType'-b1c1 changed    Case DC40        Ret = DCGetStatus(CameraData, GenericStatus, FullDC40Status)    Case DC50        Ret = DCGetStatus(CameraData, GenericStatus, FullDC50Status)    Case DC120        Ret = DCGetStatus(CameraData, GenericStatus, FullDC120Status)    Case Else    End Select    StatusBar1.SimpleText = "DCGetStatus:" & DCMakeErrorMessage(Ret)           If Ret < DC_NoErr Then        GoTo EndLine    End If        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        CamMemType = Val(Text2.Text)        Select Case CamMemType    Case DCCameraMemory        NumOfAlbums = FullDC120Status.MemNumAlbums + 1    Case DCPCCard        NumOfAlbums = FullDC120Status.CardNumAlbums + 1    End Select        ReDim AllAlbum(NumOfAlbums)        Form1.StatusBar1.SimpleText = "Now Calling DCAlbumGetAllName..."    Form1.Refresh        Ret = DCAlbumGetAllName(CameraData, CamMemType, AllAlbum(0))    StatusBar1.SimpleText = "DCAlbumGetAllName:" & DCMakeErrorMessage(Ret)    If Ret = DC_NoErr Then        Load Form3        Form3.Caption = "DCAlbumGetAllName"        Form3.List1.Clear        Form3.Picture1.Visible = False        Form3.Label1.Visible = False            For Cnt2 = 0 To NumOfAlbums - 1            For Cnt = 0 To DC120OneAlbumLength - 1                TempStr = TempStr & Chr(AllAlbum(Cnt2).AlbumName(Cnt))            Next Cnt            Form3.List1.AddItem "Album" & Cnt2 + 1            Form3.List1.AddItem "AlbumName : " & TempStr            Form3.List1.AddItem "PictNum   : " & AllAlbum(Cnt2).PictNum            TempStr = ""        Next Cnt2                Form3.Show        End IfEndLine:End SubPrivate Sub Menu_DCAlbumGetAvailable_Click()    Dim Ret As Integer    Dim Cnt As Integer    Dim Cnt2 As Integer    Dim TempStr As String        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        For Cnt = 0 To DC120AvailableAlbumSize - 1        AvailableAlbum(Cnt) = &H0    Next Cnt        StatusBar1.SimpleText = "Now Calling DCAlbumGetAvailable..."    Form1.Refresh        Ret = DCAlbumGetAvailable(CameraData, AvailableAlbum(0))        StatusBar1.SimpleText = "DCAlbumGetAvailable:" & DCMakeErrorMessage(Ret)        If Ret = DC_NoErr Then        Load Form3        Form3.Caption = "DCAlbumGetAvailable"        Form3.List1.Clear        Form3.Picture1.Visible = False        Form3.Label1.Visible = False            For Cnt2 = 0 To 7            For Cnt = 0 To DC120OneAlbumLength - 1                TempStr = TempStr & Chr(AvailableAlbum(Cnt2 * DC120OneAlbumLength + Cnt))            Next Cnt            Form3.List1.AddItem "Album" & Cnt2 + 1 & " : " & TempStr            TempStr = ""        Next Cnt2                Form3.Show        End IfEnd SubPrivate Sub Menu_DCAlbumGetPictureName_Click()    Dim Ret As Integer    Dim Cnt As Integer    Dim Cnt2 As Integer    Dim TempStr As String    Dim PictName() As Byte    Dim NumOfAlbums As Integer        StatusBar1.SimpleText = "Now Calling DCGetStatus..."    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType'-b1c1 changed    Case DC40        Ret = DCGetStatus(CameraData, GenericStatus, FullDC40Status)    Case DC50        Ret = DCGetStatus(CameraData, GenericStatus, FullDC50Status)    Case DC120        Ret = DCGetStatus(CameraData, GenericStatus, FullDC120Status)    Case Else    End Select    StatusBar1.SimpleText = "DCGetStatus:" & DCMakeErrorMessage(Ret)           If Ret < DC_NoErr Then        GoTo EndLine    End If        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        CamMemType = Val(Text2.Text)        Select Case CamMemType    Case DCCameraMemory        NumOfAlbums = FullDC120Status.MemNumAlbums + 1    Case DCPCCard        NumOfAlbums = FullDC120Status.CardNumAlbums + 1    End Select        ReDim AllAlbum(NumOfAlbums)        Form1.StatusBar1.SimpleText = "Now Calling DCAlbumGetAllName..."    Form1.Refresh        Ret = DCAlbumGetAllName(CameraData, CamMemType, AllAlbum(0))    StatusBar1.SimpleText = "DCAlbumGetAllName:" & DCMakeErrorMessage(Ret)    If Ret < DC_NoErr Then        GoTo EndLine    End If        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        CamMemType = Val(Text2.Text)    AlbumNum = Val(Text3.Text)        ReDim PictName(DC120AlbumPictureSize * AllAlbum(AlbumNum).PictNum)        For Cnt = 0 To DC120AlbumPictureSize * AllAlbum(AlbumNum).PictNum - 1        PictName(Cnt) = &H0    Next Cnt        StatusBar1.SimpleText = "Now Calling DCAlbumGetPictureName..."    Form1.Refresh        Ret = DCAlbumGetPictureName(CameraData, CamMemType, AlbumNum, PictName(0))        StatusBar1.SimpleText = "DCAlbumGetPictureName:" & DCMakeErrorMessage(Ret)        If Ret = DC_NoErr Then        Load Form3        Form3.Caption = "DCAlbumGetPictureName"        Form3.List1.Clear        Form3.Picture1.Visible = False        Form3.Label1.Visible = False            For Cnt2 = 0 To AllAlbum(AlbumNum).PictNum - 1            For Cnt = 0 To DC120AlbumPictureSize - 1                TempStr = TempStr & Chr(PictName(Cnt2 * DC120AlbumPictureSize + Cnt))            Next Cnt            Form3.List1.AddItem "PictName" & Cnt2 + 1 & " : " & TempStr            TempStr = ""        Next Cnt2                Form3.Show        End IfEndLine:End SubPrivate Sub Menu_DCAlbumMoveImage_Click()    Dim Ret As Integer        CamMemType = Val(Text2.Text)    PictNum = Val(Text1.Text)    FromAlbumNum = Val(Text6.Text)    ToAlbumNum = Val(Text7.Text)        Form1.StatusBar1.SimpleText = "Now Calling DCAlbumMoveImage..."    Form1.Refresh        Ret = DCAlbumMoveImage(CameraData, CamMemType, PictNum, FromAlbumNum, ToAlbumNum)    StatusBar1.SimpleText = "DCAlbumMoveImage:" & DCMakeErrorMessage(Ret)End SubPrivate Sub Menu_DCAlbumSetActive_Click()    Dim Ret As Integer        ActiveAlbum = Val(Text5.Text)        Form1.StatusBar1.SimpleText = "Now Calling DCAlbumSetActive..."    Form1.Refresh        Ret = DCAlbumSetActive(CameraData, ActiveAlbum)    StatusBar1.SimpleText = "DCAlbumSetActive:" & DCMakeErrorMessage(Ret)End SubPrivate Sub Menu_DCAlbumSetAvailable_Click()    Dim Ret As Integer    Dim Cnt As Integer    Dim Cnt2 As Integer    Dim TempStr As String        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        For Cnt = 0 To DC120AvailableAlbumSize - 1        AvailableAlbum(Cnt) = &H0    Next Cnt        StatusBar1.SimpleText = "Now Calling DCAlbumGetAvailable..."    Form1.Refresh        Ret = DCAlbumGetAvailable(CameraData, AvailableAlbum(0))        StatusBar1.SimpleText = "DCAlbumGetAvailable:" & DCMakeErrorMessage(Ret)        If Ret < DC_NoErr Then        GoTo EndLine    End If        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        Load DCAlbumSetAvailableDlg             For Cnt2 = 0 To 7        For Cnt = 0 To DC120OneAlbumLength - 1            TempStr = TempStr & Chr(AvailableAlbum(Cnt2 * DC120OneAlbumLength + Cnt))        Next Cnt        DCAlbumSetAvailableDlg.Text1(Cnt2) = TempStr        TempStr = ""    Next Cnt2        DCAlbumSetAvailableDlg.Show    EndLine:End SubPrivate Sub Menu_DCGetCameraPictureAsJPEG_Click()        Dim Ret As Integer'+1.03 changed'    Dim JPEGFileNum As Integer'-1.03 changed    Dim InputSize As Long, OutputSize As Long    Dim InputBuf() As Byte, OutputBuf() As Byte    Dim JPEGFileName As String    Dim ThumbImage(1) As Byte'+1.03 changed    Dim hfile_dest As Long    Dim Lx As Long    Dim sts As Long'-1.03 changed        CamMemType = Val(Text2.Text)    AlbumNum = Val(Text3.Text)    PictNum = Val(Text1.Text)        Form1.StatusBar1.SimpleText = "Now Calling DCGetCameraPictInfo..."    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType'-b1c1 changed    Case DC40        Ret = DCGetCameraPictInfo(CameraData, CamMemType, AlbumNum, PictNum, False, ThumbImage(0), GenericPictInfo, FullDC40PictInfo)    Case DC50        Ret = DCGetCameraPictInfo(CameraData, CamMemType, AlbumNum, PictNum, False, ThumbImage(0), GenericPictInfo, FullDC50PictInfo)    Case DC120        Ret = DCGetCameraPictInfo(CameraData, CamMemType, AlbumNum, PictNum, False, ThumbImage(0), GenericPictInfo, FullDC120PictInfo)    End Select    StatusBar1.SimpleText = "DCGetCameraPictInfo:" & DCMakeErrorMessage(Ret)        If Ret < DC_NoErr Then        GoTo EndLine    End If        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        CompLevel = Val(Text4.Text)        InputSize = GenericPictInfo.PictMinBufIn            ReDim InputBuf(InputSize)    OutputSize = DCJPEGTempSize    ReDim OutputBuf(OutputSize)        Form1.StatusBar1.SimpleText = "Now Calling DCGetCameraPictureAsJPEG..."    Form1.Refresh        Ret = DCGetCameraPictureAsJPEG(CameraData, CamMemType, AlbumNum, GenericPictInfo, CompLevel, JPEGSize, InputSize, InputBuf(0), OutputSize, OutputBuf(0))    StatusBar1.SimpleText = "DCGetCameraPictureAsJPEG:" & DCMakeErrorMessage(Ret)           If Ret = DC_NoErr Then        CommonDialog1.filename = ""        CommonDialog1.Filter = "JPEG Pictures (*.jpg)|*.jpg|All Files (*.*)|*.*"        CommonDialog1.ShowSave        JPEGFileName = CommonDialog1.filename        If CommonDialog1.filename = "" Then            Exit Sub        Else            JPEGFileName = CommonDialog1.filename        End If       '+1.03 changed        hfile_dest = lcreat(JPEGFileName, 0)        ReDim Preserve OutputBuf(JPEGSize)        Lx = hwrite(hfile_dest, OutputBuf(0), JPEGSize)        sts = lclose(hfile_dest)        '        JPEGFileNum = FreeFile'        Open CommonDialog1.filename For Binary Access Write As JPEGFileNum'        ReDim Preserve OutputBuf(JPEGSize)'        Put JPEGFileNum, , OutputBuf'        Close JPEGFileNum'+1.03 changed    End IfEndLine:End SubPrivate Sub Menu_DCGetOutputWindow_Click()    Dim Ret As Integer        Form1.StatusBar1.SimpleText = "Now Calling DCGetOutputWindow..."    Form1.Refresh        Ret = DCGetOutputWindow(CameraData, WindowData)    StatusBar1.SimpleText = "DCGetOutputWindow:" & DCMakeErrorMessage(Ret)           If Ret = DC_NoErr Then        Load Form3        Form3.Caption = "DCGetOutputWindow"        Form3.List1.Clear        Form3.Picture1.Visible = False        Form3.Label1.Visible = False                Form3.List1.AddItem " - WindowData -"        Form3.List1.AddItem "HOffset       : " & WindowData.HOffset        Form3.List1.AddItem "VOffset       : " & WindowData.VOffset        Form3.List1.AddItem "Width         : " & WindowData.Width        Form3.List1.AddItem "Height        : " & WindowData.Height        Form3.List1.AddItem "RowBytes      : " & WindowData.RowBytes        Form3.List1.AddItem "ThumbRowBytes : " & WindowData.ThumbRowBytes                Form3.Show            End IfEnd SubPrivate Sub Menu_DCPreviewErase_Click()    Dim Ret As Integer    Form1.StatusBar1.SimpleText = "Now Calling DCPreviewErase..."    Form1.Refresh        Ret = DCPreviewErase(CameraData)    StatusBar1.SimpleText = "DCPreviewErase:" & DCMakeErrorMessage(Ret)End SubPrivate Sub Menu_DCPreviewGetInfo_Click()    Dim Ret As Integer    Form1.StatusBar1.SimpleText = "Now Calling DCPreviewGetInfo..."    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType'-b1c1 changed    Case DC40        Ret = DCPreviewGetInfo(CameraData, FullDC50PreviewInfo)    Case DC50        Ret = DCPreviewGetInfo(CameraData, FullDC50PreviewInfo)    Case DC120        Ret = DCPreviewGetInfo(CameraData, FullDC50PreviewInfo)    End Select    StatusBar1.SimpleText = "DCPreviewGetInfo:" & DCMakeErrorMessage(Ret)        If Ret = DC_NoErr Then        Load Form3        Form3.Caption = "DCPreviewGetInfo"        Form3.Label1.Visible = False        Form3.Picture1.Visible = False        Form3.List1.Clear        '+b1c1 changed'           Select Case CameraData.Driver.GenericCameraType            Select Case CameraData.Driver.SpecificCamType'-b1c1 changed        Case DC50            Form3.List1.AddItem " - PreviewInfo(DC50PreviewInfo) -"            Form3.List1.AddItem "PictWidth     : " & FullDC50PreviewInfo.PictWidth            Form3.List1.AddItem "PictHeight    : " & FullDC50PreviewInfo.PictHeight            Form3.List1.AddItem "PictComp Size : " & FullDC50PreviewInfo.PictCompSize            Form3.List1.AddItem "PictMinBufIn  : " & FullDC50PreviewInfo.PictMinBufIn            Form3.List1.AddItem "PictMinBufOut : " & FullDC50PreviewInfo.PictMinBufOut            Form3.List1.AddItem "PictType      : " & FullDC50PreviewInfo.PictType        End Select                Form3.Show    End IfEnd SubPrivate Sub Menu_DCPreviewGetPicture_Click()        Dim Ret As Integer    Dim InputSize As Long, InputBuf() As Byte    Dim OutputSize As Long, OutputBuf() As Byte    Dim PictHeight As Long, PictWidth As Long    Dim Cnt1 As Long, Cnt2 As Long    Dim GrayScale As Integer    Form1.StatusBar1.SimpleText = "Now Calling DCPreviewGetInfo..."    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType'-b1c1 changed    Case DC40        Ret = DCPreviewGetInfo(CameraData, FullDC50PreviewInfo)    Case DC50        Ret = DCPreviewGetInfo(CameraData, FullDC50PreviewInfo)    Case DC120        Ret = DCPreviewGetInfo(CameraData, FullDC50PreviewInfo)    End Select    StatusBar1.SimpleText = "DCPreviewGetInfo:" & DCMakeErrorMessage(Ret)        If Ret < DC_NoErr Then        GoTo EndLine    End If        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        InputSize = FullDC50PreviewInfo.PictMinBufIn    OutputSize = FullDC50PreviewInfo.PictMinBufOut    ReDim InputBuf(InputSize)    ReDim OutputBuf(OutputSize)            Form1.StatusBar1.SimpleText = "Now Calling DCPreviewGetPicture..."    Form1.Refresh        Ret = DCPreviewGetPicture(CameraData, InputSize, InputBuf(0), OutputSize, OutputBuf(0))    StatusBar1.SimpleText = "DCPreviewGetPicture:" & DCMakeErrorMessage(Ret)    Form1.Refresh            If Ret = DC_NoErr Then        Load Form5        Form5.Menu_File.Enabled = False                    PictHeight = FullDC50PreviewInfo.PictHeight - 1        PictWidth = FullDC50PreviewInfo.PictWidth * 3 - 1        For Cnt1 = PictHeight To 0 Step -1            For Cnt2 = 0 To PictWidth Step 3                GrayScale = CInt(OutputBuf(Cnt1 * (PictWidth + 1) + Cnt2))                Form5.Picture1.PSet (Cnt2 / 3, PictHeight - Cnt1), RGB(GrayScale, GrayScale, GrayScale)            Next Cnt2        Next Cnt1                    Form5.Show    End IfEndLine:End SubPrivate Sub Menu_DCPreviewStore_Click()    Dim Ret As Integer    Dim ThumbFlag As Integer, ThumbImage() As Byte    Dim Cnt1 As Integer, Cnt2 As Integer    Dim ThumbWidth As Integer, ThumbHeight As Integer    Dim Angle As Long            Form1.StatusBar1.SimpleText = ""    Form1.Refresh        If Check1.Value = 1 Then'+b1c1 changed'       Select Case CameraData.Driver.GenericCameraType        Select Case CameraData.Driver.SpecificCamType'-b1c1 changed        Case DC40            ReDim ThumbImage(DC40ThumbSize)        Case DC50            ReDim ThumbImage(DC50ThumbSize)        Case DC120            ReDim ThumbImage(DC120ThumbSize)        End Select        ThumbFlag = True    Else        ReDim ThumbImage(1)        ThumbFlag = False    End If        CamMemType = Val(Text2.Text)        Form1.StatusBar1.SimpleText = "Now Calling DCPreviewStore..."    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType'-b1c1 changed    Case DC40        Ret = DCPreviewStore(CameraData, CamMemType, ThumbFlag, ThumbImage(0), GenericPictInfo, FullDC40PictInfo)    Case DC50        Ret = DCPreviewStore(CameraData, CamMemType, ThumbFlag, ThumbImage(0), GenericPictInfo, FullDC50PictInfo)    Case DC120        Ret = DCPreviewStore(CameraData, CamMemType, ThumbFlag, ThumbImage(0), GenericPictInfo, FullDC120PictInfo)    End Select    StatusBar1.SimpleText = "DCPreviewStore:" & DCMakeErrorMessage(Ret)    If Ret = DC_NoErr Then        Load Form3        Form3.Caption = "DCPreviewStore"        Form3.List1.Clear        Form3.Picture1.Visible = True                SetGenericPictInfoToList       '+b1c1 changed'       Select Case CameraData.Driver.GenericCameraType        Select Case CameraData.Driver.SpecificCamType'-b1c1 changed        Case DC40            SetDC40PictInfoToList        Case DC50            SetDC50PictInfoToList        Case DC120            SetDC120PictInfoToList        End Select            Form3.Show                If IPData.RotateFlag Then            Angle = IPData.RotateAngle        Else            Angle = DCRotate0        End If        If Angle = DCUsePictOrientation Then'+b1c1 changed'           Select Case CameraData.Driver.GenericCameraType            Select Case CameraData.Driver.SpecificCamType'-b1c1 changed            Case DC40                Angle = FullDC40PictInfo.PictOrientation            Case DC50                Angle = FullDC50PictInfo.PictOrientation            Case DC120                Angle = FullDC120PictInfo.PictOrientation            End Select        End If        Select Case Angle        Case DCRotate0            ThumbWidth = GenericPictInfo.ThumbWidth            ThumbHeight = GenericPictInfo.ThumbHeight        Case DCRotate180            ThumbWidth = GenericPictInfo.ThumbWidth            ThumbHeight = GenericPictInfo.ThumbHeight        Case DCRotate90            ThumbWidth = GenericPictInfo.ThumbHeight            ThumbHeight = GenericPictInfo.ThumbWidth        Case DCRotate270            ThumbWidth = GenericPictInfo.ThumbHeight            ThumbHeight = GenericPictInfo.ThumbWidth        End Select        If Check1.Value = 1 Then            For Cnt1 = (ThumbHeight - 1) To 0 Step -1                For Cnt2 = 0 To (ThumbWidth * 3 - 1) Step 3                    Form3.Picture1.PSet (Cnt2 / 3, ThumbHeight - 1 - Cnt1), RGB(CInt(ThumbImage(Cnt1 * ThumbWidth * 3 + Cnt2 + 2)), CInt(ThumbImage(Cnt1 * ThumbWidth * 3 + Cnt2 + 1)), ThumbImage(CInt(Cnt1 * ThumbWidth * 3 + Cnt2)))                Next Cnt2            Next Cnt1        End If                    End IfEnd SubPrivate Sub Menu_DCProcNativePictureAsJPEG_Click()    '+1.03 changed'    Dim JPEGFileNum As Integer'-1.03 changed    Dim Ret As Integer    Dim OutputBuf() As Byte    Dim TIFFEPFileName As String    Dim FileNum As Integer    Dim JPEGFileName As String    Dim ThumbImage(1) As Byte'+1.03 changed    Dim hfile_dest As Long    Dim Lx As Long    Dim sts As Long'-1.03 changed        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        CommonDialog1.filename = ""    CommonDialog1.Filter = "DC40/50/120 Pictures (*.kdc)|*.kdc|All Files (*.*)|*.*"    CommonDialog1.ShowOpen        If CommonDialog1.filename = "" Then        Exit Sub    Else        TIFFEPFileName = CommonDialog1.filename    End If           FileNum = FreeFile    Open TIFFEPFileName For Binary Access Read As FileNum    TIFFEPSize = LOF(FileNum)        If TIFFEPSize = 0 Then        StatusBar1.SimpleText = "DCProcNativePicture:FileNotFound"        Close FileNum        Kill TIFFEPFileName        Exit Sub    Else        ReDim TIFFEPBuf(TIFFEPSize)        Get FileNum, , TIFFEPBuf        Close FileNum    End If          Form1.StatusBar1.SimpleText = "Now Calling DCGetNativeCameraType..."    Form1.Refresh        Ret = DCGetNativeCameraType(CameraData, TIFFEPSize, TIFFEPBuf(0), CamType)    StatusBar1.SimpleText = "DCGetNativeCameraType:" & DCMakeErrorMessage(Ret)        If Ret < DC_NoErr Then        GoTo EndLine    End If        Form1.StatusBar1.SimpleText = "Now Calling DCGetNativePictInfo..."    Form1.Refresh        Select Case CamType    Case DC40        Ret = DCGetNativePictInfo(CameraData, TIFFEPSize, TIFFEPBuf(0), False, ThumbImage(0), GenericPictInfo, FullDC40PictInfo)    Case DC50        Ret = DCGetNativePictInfo(CameraData, TIFFEPSize, TIFFEPBuf(0), False, ThumbImage(0), GenericPictInfo, FullDC50PictInfo)    Case DC120        Ret = DCGetNativePictInfo(CameraData, TIFFEPSize, TIFFEPBuf(0), False, ThumbImage(0), GenericPictInfo, FullDC120PictInfo)    End Select    StatusBar1.SimpleText = "DCGetNativePictInfo:" & DCMakeErrorMessage(Ret)            If Ret < DC_NoErr Then        GoTo EndLine    End If        CompLevel = 1    ReDim OutputBuf(DCJPEGTempSize)        Form1.StatusBar1.SimpleText = "Now Calling DCProvNativePictureAsJPEG..."    Form1.Refresh        Ret = DCProcNativePictureAsJPEG(CameraData, GenericPictInfo, CompLevel, JPEGSize, TIFFEPSize, TIFFEPBuf(0), DCJPEGTempSize, OutputBuf(0))    StatusBar1.SimpleText = "DCProvNativePictureAsJPEG:" & DCMakeErrorMessage(Ret)           If Ret = DC_NoErr Then        CommonDialog1.filename = ""        CommonDialog1.Filter = "JPEG Pictures (*.jpg)|*.jpg|All Files (*.*)|*.*"        CommonDialog1.ShowSave        JPEGFileName = CommonDialog1.filename        If CommonDialog1.filename = "" Then            Exit Sub        Else            JPEGFileName = CommonDialog1.filename        End If       '+1.03 changed        hfile_dest = lcreat(JPEGFileName, 0)        ReDim Preserve OutputBuf(JPEGSize)        Lx = hwrite(hfile_dest, OutputBuf(0), JPEGSize)        sts = lclose(hfile_dest)        '        JPEGFileNum = FreeFile'        Open CommonDialog1.filename For Binary Access Write As JPEGFileNum'        ReDim Preserve OutputBuf(JPEGSize)'        Put JPEGFileNum, , OutputBuf'        Close JPEGFileNum'-1.03 changed    End IfEndLine:End SubPrivate Sub Menu_DCSetOutputWindow_Click()    Dim Ret As Integer        Form1.StatusBar1.SimpleText = "Now Calling DCGetOutputWindow..."    Form1.Refresh        Ret = DCGetOutputWindow(CameraData, WindowData)    StatusBar1.SimpleText = "DCGetOutputWindow:" & DCMakeErrorMessage(Ret)           If Ret < DC_NoErr Then        GoTo EndLine    End If        StatusBar1.SimpleText = ""    Form1.Refresh        Load DCSetOutputWindowDlg        DCSetOutputWindowDlg.Text1 = WindowData.HOffset    DCSetOutputWindowDlg.Text2 = WindowData.VOffset    DCSetOutputWindowDlg.Text3 = WindowData.Width    DCSetOutputWindowDlg.Text4 = WindowData.Height    DCSetOutputWindowDlg.Text5 = WindowData.RowBytes    DCSetOutputWindowDlg.Text6 = WindowData.ThumbRowBytes        DCSetOutputWindowDlg.Show    EndLine:End SubPrivate Sub Menu11_Click()    Dim Ret As Integer    Dim Version As Integer        Version = DCSDKVersion        Form1.StatusBar1.SimpleText = "Now Calling DCOpenDriver..."    Form1.Refresh        Ret = DCOpenDriver(Version, CameraData.Driver)    StatusBar1.SimpleText = "DCOpenDriver:" & DCMakeErrorMessage(Ret)End SubPrivate Sub Menu12_Click()    Dim Ret As Integer        StatusBar1.SimpleText = "Now Calling DCCloseDriver..."    Form1.Refresh        Ret = DCCloseDriver(CameraData.Driver)    StatusBar1.SimpleText = "DCCloseDriver:" & DCMakeErrorMessage(Ret)End SubPrivate Sub Menu13_Click()    Form1.StatusBar1.SimpleText = ""    Form1.Refresh        Load DCOpenCameraDlg        DCOpenCameraDlg.Show    End SubPrivate Sub Menu14_Click()    Dim Ret As Integer            StatusBar1.SimpleText = "Now Calling DCCloseCamera..."    Form1.Refresh        Ret = DCCloseCamera(CameraData)    StatusBar1.SimpleText = "DCCloseCamera:" & DCMakeErrorMessage(Ret)End SubPrivate Sub Menu21_Click()        Dim Ret As Integer    Dim Cnt As Integer    Dim TempStr As String        StatusBar1.SimpleText = "Now Calling DCGetStatus..."    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType'-b1c1 changed    Case DC40        Ret = DCGetStatus(CameraData, GenericStatus, FullDC40Status)    Case DC50        Ret = DCGetStatus(CameraData, GenericStatus, FullDC50Status)    Case DC120        Ret = DCGetStatus(CameraData, GenericStatus, FullDC120Status)    Case Else    End Select    StatusBar1.SimpleText = "DCGetStatus:" & DCMakeErrorMessage(Ret)           If Ret = DC_NoErr Then        Load Form3        Form3.Caption = "DCGetStatus"        Form3.List1.Clear        Form3.Picture1.Visible = False        Form3.Label1.Visible = False                Form3.List1.AddItem " - GenericStatus -"        Form3.List1.AddItem "Time     tm_year  : " & GenericStatus.Time.tm_year        Form3.List1.AddItem "         tm_mon   : " & GenericStatus.Time.tm_mon        Form3.List1.AddItem "         tm_mday  : " & GenericStatus.Time.tm_mday        Form3.List1.AddItem "         tm_hour  : " & GenericStatus.Time.tm_hour        Form3.List1.AddItem "         tm_min   : " & GenericStatus.Time.tm_min        Form3.List1.AddItem "         tm_sec   : " & GenericStatus.Time.tm_sec        Form3.List1.AddItem "         tm_wday  : " & GenericStatus.Time.tm_wday        Form3.List1.AddItem "         tm_yday  : " & GenericStatus.Time.tm_yday        Form3.List1.AddItem "         tm_isdst : " & GenericStatus.Time.tm_isdst        Form3.List1.AddItem "FirmwareVersion   : " & GenericStatus.FirmwareVersion        Form3.List1.AddItem "NumPictTaken      : " & GenericStatus.NumPictTaken        Form3.List1.AddItem "NumPictRemaining  : " & GenericStatus.NumPictRemaining        Form3.List1.AddItem "MemPictTaken      : " & GenericStatus.MemPictTaken        Form3.List1.AddItem "MemPictRemaining  : " & GenericStatus.MemPictRemaining        Form3.List1.AddItem "CardPictTaken     : " & GenericStatus.CardPictTaken        Form3.List1.AddItem "CardPictRemaining : " & GenericStatus.CardPictRemaining        Form3.List1.AddItem "ThumbWidth        : " & GenericStatus.ThumbWidth        Form3.List1.AddItem "ThumbHeight       : " & GenericStatus.ThumbHeight        Form3.List1.AddItem "PictWidth         : " & GenericStatus.PictWidth        Form3.List1.AddItem "PictHeight        : " & GenericStatus.PictHeight    '+b1c1 changed'       Select Case CameraData.Driver.GenericCameraType        Select Case CameraData.Driver.SpecificCamType'-b1c1 changed        Case DC40            Form3.List1.AddItem " - FullStatus(DC40Status) -"            Form3.List1.AddItem "BattetyLevel   : " & FullDC40Status.BatteryLevel            Form3.List1.AddItem "BatteryCharger : " & FullDC40Status.BatteryCharger            Form3.List1.AddItem "HiResRemaining : " & FullDC40Status.HiResRemaining            Form3.List1.AddItem "LoResRemaining : " & FullDC40Status.LoResRemaining        Case DC50            Form3.List1.AddItem " - FullStatus(DC50Status) -"            Form3.List1.AddItem "BattetyLevel       : " & FullDC50Status.BatteryLevel            Form3.List1.AddItem "ACAdapter          : " & FullDC50Status.ACAdapter            Form3.List1.AddItem "CardAvailable      : " & FullDC50Status.CardAvailable            Form3.List1.AddItem "MemFirstImageNum   : " & FullDC50Status.MemFirstImageNum            Form3.List1.AddItem "MemNumberOfImages  : " & FullDC50Status.MemNumberOfImages            Form3.List1.AddItem "CardFirstImageNum  : " & FullDC50Status.CardFirstImageNum            Form3.List1.AddItem "CardNumberOfImages : " & FullDC50Status.CardNumberOfImages            Form3.List1.AddItem "LightValue         : " & FullDC50Status.LightValue            Form3.List1.AddItem "ProgramStatus      : " & FullDC50Status.ProgramStatus            Form3.List1.AddItem "MemBestTaken       : " & FullDC50Status.MemBestTaken            Form3.List1.AddItem "MemBetterTaken     : " & FullDC50Status.MemBetterTaken            Form3.List1.AddItem "MemGoodTaken       : " & FullDC50Status.MemGoodTaken            Form3.List1.AddItem "MemBestRemaining   : " & FullDC50Status.MemBestRemaining            Form3.List1.AddItem "MemBetterRemaining : " & FullDC50Status.MemBetterRemaining            Form3.List1.AddItem "MemGoodRemaining   : " & FullDC50Status.MemGoodRemaining            Form3.List1.AddItem "ATABestTaken       : " & FullDC50Status.ATABestTaken            Form3.List1.AddItem "ATABetterTaken     : " & FullDC50Status.ATABetterTaken            Form3.List1.AddItem "ATAGoodTaken       : " & FullDC50Status.ATAGoodTaken            Form3.List1.AddItem "ATABestRemaining   : " & FullDC50Status.ATABestRemaining            Form3.List1.AddItem "ATABetterRemaining : " & FullDC50Status.ATABetterRemaining            Form3.List1.AddItem "ATAGoodRemaining   : " & FullDC50Status.ATAGoodRemaining            For Cnt = 0 To 11                TempStr = TempStr & Chr(FullDC50Status.ATAVolumeName(Cnt))            Next Cnt            Form3.List1.AddItem "ATAVolumeName      : " & TempStr        Case DC120            Form3.List1.AddItem " - FullStatus(DC120Status) -"            Form3.List1.AddItem "BattetyLevel        : " & FullDC120Status.BatteryLevel            Form3.List1.AddItem "ACAdapter           : " & FullDC120Status.ACAdapter            Form3.List1.AddItem "CardAvailable       : " & FullDC120Status.CardAvailable            Form3.List1.AddItem "CoverStatus         : " & FullDC120Status.CoverStatus            Form3.List1.AddItem "FlashStatus         : " & FullDC120Status.FlashStatus            Form3.List1.AddItem "LightValue          : " & FullDC120Status.LightValue            Form3.List1.AddItem "MemNumImages        : " & FullDC120Status.MemNumImages            Form3.List1.AddItem "MemNoCompRemaining  : " & FullDC120Status.MemNoCompRemaining            Form3.List1.AddItem "MemBestRemaining    : " & FullDC120Status.MemBestRemaining            Form3.List1.AddItem "MemBetterRemaining  : " & FullDC120Status.MemBetterRemaining            Form3.List1.AddItem "MemGoodRemaining    : " & FullDC120Status.MemGoodRemaining            Form3.List1.AddItem "MemNumAlbums        : " & FullDC120Status.MemNumAlbums            Form3.List1.AddItem "CardNumImages       : " & FullDC120Status.CardNumImages            Form3.List1.AddItem "CardNoCompRemaining : " & FullDC120Status.CardNoCompRemaining            Form3.List1.AddItem "CardBestRemaining   : " & FullDC120Status.CardBestRemaining            Form3.List1.AddItem "CardBetterRemaining : " & FullDC120Status.CardBetterRemaining            Form3.List1.AddItem "CardGoodRemaining   : " & FullDC120Status.CardGoodRemaining            Form3.List1.AddItem "CardNumAlbums       : " & FullDC120Status.CardNumAlbums            For Cnt = 0 To 11                TempStr = TempStr & Chr(FullDC120Status.CardVolumeName(Cnt))            Next Cnt            Form3.List1.AddItem "CardVolumeName      : " & TempStr        End Select                Form3.Show            End IfEnd SubPrivate Sub Menu22_Click()    Dim Ret As Integer    Dim Cnt As Integer    Dim TempStr As String    Dim BufL As Long        StatusBar1.SimpleText = "Now Calling DCGetConfig..."    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType'-b1c1 changed    Case DC40        Ret = DCGetConfig(CameraData, GenericConfig, FullDC40Config)    Case DC50        Ret = DCGetConfig(CameraData, GenericConfig, FullDC50Config)    Case DC120        Ret = DCGetConfig(CameraData, GenericConfig, FullDC120Config)    End Select    StatusBar1.SimpleText = "DCGetConfig:" & DCMakeErrorMessage(Ret)        If Ret = DC_NoErr Then        Load Form3        Form3.Caption = "DCGetStatus"        Form3.List1.Clear        Form3.Picture1.Visible = False        Form3.Label1.Visible = False                Form3.List1.AddItem " - GenericConfig -"        Form3.List1.AddItem "Time     tm_year  : " & GenericConfig.Time.tm_year        Form3.List1.AddItem "         tm_mon   : " & GenericConfig.Time.tm_mon        Form3.List1.AddItem "         tm_mday  : " & GenericConfig.Time.tm_mday        Form3.List1.AddItem "         tm_hour  : " & GenericConfig.Time.tm_hour        Form3.List1.AddItem "         tm_min   : " & GenericConfig.Time.tm_min        Form3.List1.AddItem "         tm_sec   : " & GenericConfig.Time.tm_sec        Form3.List1.AddItem "         tm_wday  : " & GenericConfig.Time.tm_wday        Form3.List1.AddItem "         tm_yday  : " & GenericConfig.Time.tm_yday        Form3.List1.AddItem "         tm_isdst : " & GenericConfig.Time.tm_isdst        For Cnt = 0 To 32            TempStr = TempStr & Chr(GenericConfig.CamId(Cnt))        Next Cnt        Form3.List1.AddItem "CamId             : " & TempStr        '+b1c1 changed'       Select Case CameraData.Driver.GenericCameraType        Select Case CameraData.Driver.SpecificCamType'-b1c1 changed        Case DC40            Form3.List1.AddItem " - FullConfig(DC40Config) -"            Form3.List1.AddItem "SleepTimeout    : " & FullDC40Config.SleepTimeout            Form3.List1.AddItem "AcknowledgeMode : " & FullDC40Config.AcknowledgeMode            Form3.List1.AddItem "DefExpMode      : " & FullDC40Config.DefExpMode            BufL = FullDC40Config.DefExpMode            Form3.List1.AddItem "DefTimerMode    : " & FullDC40Config.DefTimerMode            BufL = FullDC40Config.DefTimerMode            Form3.List1.AddItem "DefFlashMode    : " & FullDC40Config.DefFlashMode            BufL = FullDC40Config.DefFlashMode            Form3.List1.AddItem "UpDownMode      : " & FullDC40Config.UpDownMode            Form3.List1.AddItem "ExpMode         : " & FullDC40Config.ExpMode            Form3.List1.AddItem "TimerMode       : " & FullDC40Config.TimerMode            Form3.List1.AddItem "FlashMode       : " & FullDC40Config.FlashMode            Form3.List1.AddItem "BeepButton      : " & FullDC40Config.BeepButton            Form3.List1.AddItem "BeepEvent       : " & FullDC40Config.BeepEvent            Form3.List1.AddItem "DeleteLast      : " & FullDC40Config.DeleteLast            Form3.List1.AddItem "DeleteAll       : " & FullDC40Config.DeleteAll            Form3.List1.AddItem "PictMode        : " & FullDC40Config.PictMode            Form3.List1.AddItem "ManualExpFlag   : " & FullDC40Config.ManualExpFlag            Form3.List1.AddItem "ManualExpTime   : " & FullDC40Config.ManualExpTime            Form3.List1.AddItem "ManualFNumber   : " & FullDC40Config.ManualFNumber        Case DC50            Form3.List1.AddItem " - FullConfig(DC50Config) -"            Form3.List1.AddItem "SleepTimeout     : " & FullDC50Config.SleepTimeout            Form3.List1.AddItem "TimerDelay       : " & FullDC50Config.TimerDelay            Form3.List1.AddItem "FlashMode        : " & FullDC50Config.FlashMode            Form3.List1.AddItem "PictQuality      : " & FullDC50Config.PictQuality            Form3.List1.AddItem "ZoomPosition     : " & FullDC50Config.ZoomPosition            Form3.List1.AddItem "ManualExpFlag    : " & FullDC50Config.ManualExpFlag            Form3.List1.AddItem "ManualExpTime    : " & FullDC50Config.ManualExpTime            Form3.List1.AddItem "ManualFNumber    : " & FullDC50Config.ManualFNumber            Form3.List1.AddItem "AutoExpCompValue : " & FullDC50Config.AutoExpCompValue            Form3.List1.AddItem "FocusMode        : " & FullDC50Config.FocusMode            Form3.List1.AddItem "ProgramMode      : " & FullDC50Config.ProgramMode            Form3.List1.AddItem "ManualExpUIFlag  : " & FullDC50Config.ManualExpUIFlag        Case DC120            Form3.List1.AddItem " - FullConfig(DC120Config) -"            Form3.List1.AddItem "CaptureSleepTO    : " & FullDC120Config.CaptureSleepTO            Form3.List1.AddItem "ReviewSleepTO     : " & FullDC120Config.ReviewSleepTO            Form3.List1.AddItem "TimerDelay        : " & FullDC120Config.TimerDelay            Form3.List1.AddItem "FlashMode         : " & FullDC120Config.FlashMode            Form3.List1.AddItem "PictQuality       : " & FullDC120Config.PictQuality            Form3.List1.AddItem "ZoomPosition      : " & FullDC120Config.ZoomPosition            Form3.List1.AddItem "ManualExpFlag     : " & FullDC120Config.ManualExpFlag            Form3.List1.AddItem "ManualExpTime     : " & FullDC120Config.ManualExpTime            Form3.List1.AddItem "ManualFNumber     : " & FullDC120Config.ManualFNumber            Form3.List1.AddItem "AutoExpCompValue  : " & FullDC120Config.AutoExpCompValue            Form3.List1.AddItem "FocusMode         : " & FullDC120Config.FocusMode            Form3.List1.AddItem "DateFormat        : " & FullDC120Config.DateFormat            Form3.List1.AddItem "TimeFormat        : " & FullDC120Config.TimeFormat            Form3.List1.AddItem "DistanceDspFormat : " & FullDC120Config.DistanceDspFormat            Form3.List1.AddItem "DefFlashMode      : " & FullDC120Config.DefFlashMode                End Select                Form3.Show    End If    End SubPrivate Sub Menu23_Click()    Dim Ret As Integer    Dim Cnt As Integer    Dim TempStr As String        StatusBar1.SimpleText = "Now Calling DCGetConfig..."    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType'-b1c1 changed    Case DC40        Ret = DCGetConfig(CameraData, GenericConfig, FullDC40Config)    Case DC50        Ret = DCGetConfig(CameraData, GenericConfig, FullDC50Config)    Case DC120        Ret = DCGetConfig(CameraData, GenericConfig, FullDC120Config)    End Select    StatusBar1.SimpleText = "DCGetConfig:" & DCMakeErrorMessage(Ret)        If Ret < DC_NoErr Then        GoTo EndLine    End If        Form1.StatusBar1.SimpleText = ""    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType    Case DC40        Load DC40SetConfigDlg                 DC40SetConfigDlg.Text2(0) = GenericConfig.Time.tm_sec        DC40SetConfigDlg.Text2(1) = GenericConfig.Time.tm_min        DC40SetConfigDlg.Text2(2) = GenericConfig.Time.tm_hour        DC40SetConfigDlg.Text2(3) = GenericConfig.Time.tm_mday        DC40SetConfigDlg.Text2(4) = GenericConfig.Time.tm_mon        DC40SetConfigDlg.Text2(5) = GenericConfig.Time.tm_year        DC40SetConfigDlg.Text2(6) = GenericConfig.Time.tm_wday        DC40SetConfigDlg.Text2(7) = GenericConfig.Time.tm_yday        DC40SetConfigDlg.Text2(8) = GenericConfig.Time.tm_isdst        For Cnt = 0 To 32            TempStr = TempStr & Chr(GenericConfig.CamId(Cnt))        Next Cnt        DC40SetConfigDlg.Text2(9) = TempStr                DC40SetConfigDlg.Text1(0) = FullDC40Config.SleepTimeout        DC40SetConfigDlg.Text1(1) = FullDC40Config.AcknowledgeMode        DC40SetConfigDlg.Text1(2) = FullDC40Config.DefExpMode        DC40SetConfigDlg.Text1(3) = FullDC40Config.DefTimerMode        DC40SetConfigDlg.Text1(4) = FullDC40Config.DefFlashMode        DC40SetConfigDlg.Text1(5) = FullDC40Config.UpDownMode        DC40SetConfigDlg.Text1(6) = FullDC40Config.ExpMode        DC40SetConfigDlg.Text1(7) = FullDC40Config.TimerMode        DC40SetConfigDlg.Text1(8) = FullDC40Config.FlashMode        DC40SetConfigDlg.Text1(9) = FullDC40Config.BeepButton        DC40SetConfigDlg.Text1(10) = FullDC40Config.BeepEvent        DC40SetConfigDlg.Text1(11) = FullDC40Config.DeleteLast        DC40SetConfigDlg.Text1(12) = FullDC40Config.DeleteAll        DC40SetConfigDlg.Text1(13) = FullDC40Config.PictMode        DC40SetConfigDlg.Text1(14) = FullDC40Config.ManualExpFlag        DC40SetConfigDlg.Text1(15) = FullDC40Config.ManualExpTime        DC40SetConfigDlg.Text1(16) = FullDC40Config.ManualFNumber            DC40SetConfigDlg.Show    Case DC50        Load DC50SetConfigDlg                DC50SetConfigDlg.Text2(0) = GenericConfig.Time.tm_sec        DC50SetConfigDlg.Text2(1) = GenericConfig.Time.tm_min        DC50SetConfigDlg.Text2(2) = GenericConfig.Time.tm_hour        DC50SetConfigDlg.Text2(3) = GenericConfig.Time.tm_mday        DC50SetConfigDlg.Text2(4) = GenericConfig.Time.tm_mon        DC50SetConfigDlg.Text2(5) = GenericConfig.Time.tm_year        DC50SetConfigDlg.Text2(6) = GenericConfig.Time.tm_wday        DC50SetConfigDlg.Text2(7) = GenericConfig.Time.tm_yday        DC50SetConfigDlg.Text2(8) = GenericConfig.Time.tm_isdst        For Cnt = 0 To 32            TempStr = TempStr & Chr(GenericConfig.CamId(Cnt))        Next Cnt        DC50SetConfigDlg.Text2(9) = TempStr                DC50SetConfigDlg.Text1(0) = FullDC50Config.SleepTimeout        DC50SetConfigDlg.Text1(1) = FullDC50Config.TimerDelay        DC50SetConfigDlg.Text1(2) = FullDC50Config.FlashMode        DC50SetConfigDlg.Text1(3) = FullDC50Config.PictQuality        DC50SetConfigDlg.Text1(4) = FullDC50Config.ZoomPosition        DC50SetConfigDlg.Text1(5) = FullDC50Config.ManualExpFlag        DC50SetConfigDlg.Text1(6) = FullDC50Config.ManualExpTime        DC50SetConfigDlg.Text1(7) = FullDC50Config.ManualFNumber        DC50SetConfigDlg.Text1(8) = FullDC50Config.AutoExpCompValue        DC50SetConfigDlg.Text1(9) = FullDC50Config.FocusMode        DC50SetConfigDlg.Text1(10) = FullDC50Config.ProgramMode        DC50SetConfigDlg.Text1(11) = FullDC50Config.ManualExpUIFlag            DC50SetConfigDlg.Show'-b1c1 changed    Case DC120        Load DC120SetConfigDlg                 DC120SetConfigDlg.Text2(0) = GenericConfig.Time.tm_sec        DC120SetConfigDlg.Text2(1) = GenericConfig.Time.tm_min        DC120SetConfigDlg.Text2(2) = GenericConfig.Time.tm_hour        DC120SetConfigDlg.Text2(3) = GenericConfig.Time.tm_mday        DC120SetConfigDlg.Text2(4) = GenericConfig.Time.tm_mon        DC120SetConfigDlg.Text2(5) = GenericConfig.Time.tm_year        DC120SetConfigDlg.Text2(6) = GenericConfig.Time.tm_wday        DC120SetConfigDlg.Text2(7) = GenericConfig.Time.tm_yday        DC120SetConfigDlg.Text2(8) = GenericConfig.Time.tm_isdst        For Cnt = 0 To 32            TempStr = TempStr & Chr(GenericConfig.CamId(Cnt))        Next Cnt        DC120SetConfigDlg.Text2(9) = TempStr                DC120SetConfigDlg.Text1(0) = FullDC120Config.CaptureSleepTO        DC120SetConfigDlg.Text1(1) = FullDC120Config.ReviewSleepTO        DC120SetConfigDlg.Text1(2) = FullDC120Config.TimerDelay        DC120SetConfigDlg.Text1(3) = FullDC120Config.FlashMode        DC120SetConfigDlg.Text1(4) = FullDC120Config.PictQuality        DC120SetConfigDlg.Text1(5) = FullDC120Config.ZoomPosition        DC120SetConfigDlg.Text1(6) = FullDC120Config.ManualExpFlag        DC120SetConfigDlg.Text1(7) = FullDC120Config.ManualExpTime        DC120SetConfigDlg.Text1(8) = FullDC120Config.ManualFNumber        DC120SetConfigDlg.Text1(9) = FullDC120Config.AutoExpCompValue        DC120SetConfigDlg.Text1(10) = FullDC120Config.FocusMode        DC120SetConfigDlg.Text1(11) = FullDC120Config.DateFormat        DC120SetConfigDlg.Text1(12) = FullDC120Config.TimeFormat        DC120SetConfigDlg.Text1(13) = FullDC120Config.DistanceDspFormat        DC120SetConfigDlg.Text1(14) = FullDC120Config.DefFlashMode            DC120SetConfigDlg.Show    End Select    EndLine:    End SubPrivate Sub Menu24_Click()    Dim Ret As Integer        Form1.StatusBar1.SimpleText = "Now Calling DCResetCamera..."    Form1.Refresh        Ret = DCResetCamera(CameraData)    StatusBar1.SimpleText = "DCResetCamera:" & DCMakeErrorMessage(Ret)End SubPrivate Sub Menu31_Click()        Dim Ret As Integer        Form1.StatusBar1.SimpleText = "Now Calling DCGetImageProcessing..."    Form1.Refresh        Ret = DCGetImageProcessing(CameraData, IPData)    StatusBar1.SimpleText = "DCGetImageProcessing:" & DCMakeErrorMessage(Ret)           If Ret = DC_NoErr Then        Load Form3        Form3.Caption = "DCGetImageProcessing"        Form3.List1.Clear        Form3.Picture1.Visible = False        Form3.Label1.Visible = False                Form3.List1.AddItem " - IPData -"        Form3.List1.AddItem "ImageType        : " & IPData.ImageType        Form3.List1.AddItem "RotateFlag       : " & IPData.RotateFlag        Form3.List1.AddItem "RotateAngle      : " & IPData.RotateAngle        Form3.List1.AddItem "UseDefaultCRT    : " & IPData.UseDefaultCRT        Form3.List1.AddItem "WhiteBalance     : " & IPData.WhiteBalance        Form3.List1.AddItem "WBManual WBGainR : " & IPData.WBManual.WBGainR        Form3.List1.AddItem "         WBGainG : " & IPData.WBManual.WBGainG        Form3.List1.AddItem "         WBGainB : " & IPData.WBManual.WBGainB        Form3.List1.AddItem "CRTData RedChroma XChroma : " & IPData.CRTData.RedChroma.XChroma        Form3.List1.AddItem "                  YChroma : " & IPData.CRTData.RedChroma.YChroma        Form3.List1.AddItem "        GrnChroma XChroma : " & IPData.CRTData.GrnChroma.XChroma        Form3.List1.AddItem "                  YChroma : " & IPData.CRTData.GrnChroma.YChroma        Form3.List1.AddItem "        BluChroma XChroma : " & IPData.CRTData.BluChroma.XChroma        Form3.List1.AddItem "                  YChroma : " & IPData.CRTData.BluChroma.YChroma        Form3.List1.AddItem "        Gammma    : " & IPData.CRTData.Gamma        Form3.List1.AddItem "        WhiteTemp : " & IPData.CRTData.WhiteTemp                Form3.Show            End IfEnd SubPrivate Sub Menu32_Click()    Dim Ret As Integer        Form1.StatusBar1.SimpleText = "Now Calling DCGetImageProcessing..."    Form1.Refresh        Ret = DCGetImageProcessing(CameraData, IPData)    StatusBar1.SimpleText = "DCGetImageProcessing:" & DCMakeErrorMessage(Ret)        If Ret < DC_NoErr Then        GoTo EndLine    End If        StatusBar1.SimpleText = ""    Form1.Refresh        Load DCSetImageProcessingDlg        DCSetImageProcessingDlg.Text1 = IPData.ImageType    DCSetImageProcessingDlg.Text2 = IPData.RotateFlag    DCSetImageProcessingDlg.Text3 = IPData.RotateAngle    DCSetImageProcessingDlg.Text4 = IPData.UseDefaultCRT    DCSetImageProcessingDlg.Text5 = IPData.WhiteBalance    DCSetImageProcessingDlg.Text6 = IPData.WBManual.WBGainR    DCSetImageProcessingDlg.Text7 = IPData.WBManual.WBGainG    DCSetImageProcessingDlg.Text8 = IPData.WBManual.WBGainB    DCSetImageProcessingDlg.Text9 = IPData.CRTData.RedChroma.XChroma    DCSetImageProcessingDlg.Text10 = IPData.CRTData.RedChroma.YChroma    DCSetImageProcessingDlg.Text11 = IPData.CRTData.GrnChroma.XChroma    DCSetImageProcessingDlg.Text12 = IPData.CRTData.GrnChroma.YChroma    DCSetImageProcessingDlg.Text13 = IPData.CRTData.BluChroma.XChroma    DCSetImageProcessingDlg.Text14 = IPData.CRTData.BluChroma.YChroma    DCSetImageProcessingDlg.Text15 = IPData.CRTData.Gamma    DCSetImageProcessingDlg.Text16 = IPData.CRTData.WhiteTemp        DCSetImageProcessingDlg.Show    EndLine:End SubPrivate Sub Menu41_Click()    Dim Ret As Integer    Dim PictNum As Integer    Dim TempStr As String, Cnt As Integer    Dim ThumbImage() As Byte    Dim ThumbFlag As Integer    Dim Cnt1 As Integer, Cnt2 As Integer    Dim ThumbWidth As Integer, ThumbHeight As Integer    Dim Angle As Long            StatusBar1.SimpleText = ""    Form1.Refresh        If Check1.Value = 1 Then'+b1c1 changed'       Select Case CameraData.Driver.GenericCameraType        Select Case CameraData.Driver.SpecificCamType'-b1c1 changed        Case DC40            ReDim ThumbImage(DC40ThumbSize)        Case DC50            ReDim ThumbImage(DC50ThumbSize)        Case DC120            ReDim ThumbImage(DC120ThumbSize)        End Select        ThumbFlag = True    Else        ReDim ThumbImage(1)        ThumbFlag = False    End If        CamMemType = Val(Text2.Text)        Form1.StatusBar1.SimpleText = "Now Calling DCTakePicture..."    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType'-b1c1 changed    Case DC40        Ret = DCTakePicture(CameraData, CamMemType, ThumbFlag, ThumbImage(0), GenericPictInfo, FullDC40PictInfo)    Case DC50        Ret = DCTakePicture(CameraData, CamMemType, ThumbFlag, ThumbImage(0), GenericPictInfo, FullDC50PictInfo)    Case DC120        Ret = DCTakePicture(CameraData, CamMemType, ThumbFlag, ThumbImage(0), GenericPictInfo, FullDC120PictInfo)    End Select    StatusBar1.SimpleText = "DCTakePicture:" & DCMakeErrorMessage(Ret)            If Ret = DC_NoErr Then        Load Form3        Form3.Caption = "DCTakePicture"        Form3.List1.Clear        Form3.Picture1.Visible = True                SetGenericPictInfoToList       '+b1c1 changed'       Select Case CameraData.Driver.GenericCameraType        Select Case CameraData.Driver.SpecificCamType'-b1c1 changed        Case DC40            SetDC40PictInfoToList        Case DC50            SetDC50PictInfoToList        Case DC120            SetDC120PictInfoToList        End Select            Form3.Show                If IPData.RotateFlag Then            Angle = IPData.RotateAngle        Else            Angle = DCRotate0        End If        If Angle = DCUsePictOrientation Then'+b1c1 changed'           Select Case CameraData.Driver.GenericCameraType            Select Case CameraData.Driver.SpecificCamType'-b1c1 changed            Case DC40                Angle = FullDC40PictInfo.PictOrientation            Case DC50                Angle = FullDC50PictInfo.PictOrientation            Case DC120                Angle = FullDC120PictInfo.PictOrientation            End Select        End If        Select Case Angle        Case DCRotate0            ThumbWidth = GenericPictInfo.ThumbWidth            ThumbHeight = GenericPictInfo.ThumbHeight        Case DCRotate180            ThumbWidth = GenericPictInfo.ThumbWidth            ThumbHeight = GenericPictInfo.ThumbHeight        Case DCRotate90            ThumbWidth = GenericPictInfo.ThumbHeight            ThumbHeight = GenericPictInfo.ThumbWidth        Case DCRotate270            ThumbWidth = GenericPictInfo.ThumbHeight            ThumbHeight = GenericPictInfo.ThumbWidth        End Select        If Check1.Value = 1 Then            For Cnt1 = (ThumbHeight - 1) To 0 Step -1                For Cnt2 = 0 To (ThumbWidth * 3 - 1) Step 3                    Form3.Picture1.PSet (Cnt2 / 3, ThumbHeight - 1 - Cnt1), RGB(CInt(ThumbImage(Cnt1 * ThumbWidth * 3 + Cnt2 + 2)), CInt(ThumbImage(Cnt1 * ThumbWidth * 3 + Cnt2 + 1)), ThumbImage(CInt(Cnt1 * ThumbWidth * 3 + Cnt2)))                Next Cnt2            Next Cnt1        End If                    End IfEnd SubPrivate Sub Menu42_Click()        Dim Ret As Integer    CamMemType = Val(Text2.Text)    AlbumNum = Val(Text3.Text)    PictNum = Val(Text1.Text)        Form1.StatusBar1.SimpleText = "Now Calling DCDeletePicture..."    Form1.Refresh        Ret = DCDeletePicture(CameraData, CamMemType, AlbumNum, PictNum)    StatusBar1.SimpleText = "DCDeletePicture:" & DCMakeErrorMessage(Ret)End SubPrivate Sub Menu43_Click()        Dim Ret As Integer    AlbumNum = Val(Text3.Text)    PictNum = Val(Text1.Text)        Form1.StatusBar1.SimpleText = "Now Calling DCCopyMemToCard..."    Form1.Refresh        Ret = DCCopyMemToCard(CameraData, AlbumNum, PictNum)    StatusBar1.SimpleText = "DCCopyMemToCard:" & DCMakeErrorMessage(Ret)End SubPrivate Sub Menu51_Click()    Dim Ret As Integer    Dim PictNum As Integer    Dim TempStr As String, Cnt As Integer    Dim ThumbImage() As Byte    Dim ThumbFlag As Integer    Dim Cnt1 As Integer, Cnt2 As Integer    Dim ThumbWidth As Integer, ThumbHeight As Integer    Dim Angle As Long            StatusBar1.SimpleText = ""    Form1.Refresh        If Check1.Value = 1 Then'+b1c1 changed'       Select Case CameraData.Driver.GenericCameraType        Select Case CameraData.Driver.SpecificCamType'-b1c1 changed        Case DC40            ReDim ThumbImage(DC40ThumbSize)        Case DC50            ReDim ThumbImage(DC50ThumbSize)        Case DC120            ReDim ThumbImage(DC120ThumbSize)        End Select        ThumbFlag = True    Else        ReDim ThumbImage(1)        ThumbFlag = False    End If        CamMemType = Val(Text2.Text)    AlbumNum = Val(Text3.Text)    PictNum = Val(Text1.Text)        Form1.StatusBar1.SimpleText = "Now Calling DCGetCameraPictInfo..."    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType'-b1c1 changed    Case DC40        Ret = DCGetCameraPictInfo(CameraData, CamMemType, AlbumNum, PictNum, ThumbFlag, ThumbImage(0), GenericPictInfo, FullDC40PictInfo)    Case DC50        Ret = DCGetCameraPictInfo(CameraData, CamMemType, AlbumNum, PictNum, ThumbFlag, ThumbImage(0), GenericPictInfo, FullDC50PictInfo)    Case DC120        Ret = DCGetCameraPictInfo(CameraData, CamMemType, AlbumNum, PictNum, ThumbFlag, ThumbImage(0), GenericPictInfo, FullDC120PictInfo)    End Select    StatusBar1.SimpleText = "DCGetCameraPictInfo:" & DCMakeErrorMessage(Ret)        If Ret = DC_NoErr Then        Load Form3        Form3.Caption = "DCGetCameraPictInfo"        Form3.List1.Clear        Form3.Picture1.Visible = True                SetGenericPictInfoToList       '+b1c1 changed'       Select Case CameraData.Driver.GenericCameraType        Select Case CameraData.Driver.SpecificCamType'-b1c1 changed        Case DC40            SetDC40PictInfoToList        Case DC50            SetDC50PictInfoToList        Case DC120            SetDC120PictInfoToList        End Select            Form3.Show                If IPData.RotateFlag Then            Angle = IPData.RotateAngle        Else            Angle = DCRotate0        End If        If Angle = DCUsePictOrientation Then'+b1c1 changed'           Select Case CameraData.Driver.GenericCameraType            Select Case CameraData.Driver.SpecificCamType'-b1c1 changed            Case DC40                Angle = FullDC40PictInfo.PictOrientation            Case DC50                Angle = FullDC50PictInfo.PictOrientation            Case DC120                Angle = FullDC120PictInfo.PictOrientation            End Select        End If        Select Case Angle        Case DCRotate0            ThumbWidth = GenericPictInfo.ThumbWidth            ThumbHeight = GenericPictInfo.ThumbHeight        Case DCRotate180            ThumbWidth = GenericPictInfo.ThumbWidth            ThumbHeight = GenericPictInfo.ThumbHeight        Case DCRotate90            ThumbWidth = GenericPictInfo.ThumbHeight            ThumbHeight = GenericPictInfo.ThumbWidth        Case DCRotate270            ThumbWidth = GenericPictInfo.ThumbHeight            ThumbHeight = GenericPictInfo.ThumbWidth        End Select        If Check1.Value = 1 Then            For Cnt1 = (ThumbHeight - 1) To 0 Step -1                For Cnt2 = 0 To (ThumbWidth * 3 - 1) Step 3                    Form3.Picture1.PSet (Cnt2 / 3, ThumbHeight - 1 - Cnt1), RGB(CInt(ThumbImage(Cnt1 * ThumbWidth * 3 + Cnt2 + 2)), CInt(ThumbImage(Cnt1 * ThumbWidth * 3 + Cnt2 + 1)), ThumbImage(CInt(Cnt1 * ThumbWidth * 3 + Cnt2)))                Next Cnt2            Next Cnt1        End If                    End IfEnd SubPrivate Sub Menu52_Click()    Dim Ret As Integer    Dim TIFFEPBuf() As Byte    Dim TIFFEPSize As Long    Dim TIFFEPFileName As String    Dim FileNum As Integer        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        CommonDialog1.filename = ""    CommonDialog1.Filter = "DC40/50/120 Pictures (*.kdc)|*.kdc|All Files (*.*)|*.*"    CommonDialog1.ShowOpen        If CommonDialog1.filename = "" Then        Exit Sub    Else        TIFFEPFileName = CommonDialog1.filename    End If           FileNum = FreeFile    Open TIFFEPFileName For Binary Access Read As FileNum    TIFFEPSize = LOF(FileNum)        If TIFFEPSize = 0 Then        StatusBar1.SimpleText = "DCGetNativeCameraType:FileNotFound"        Close FileNum        Kill TIFFEPFileName        Exit Sub    Else        ReDim TIFFEPBuf(TIFFEPSize)        Get FileNum, , TIFFEPBuf        Close FileNum    End If        Form1.StatusBar1.SimpleText = "Now Calling DCGetNativeCameraType..."    Form1.Refresh        Ret = DCGetNativeCameraType(CameraData, TIFFEPSize, TIFFEPBuf(0), CamType)    StatusBar1.SimpleText = "DCGetNativeCameraType:" & DCMakeErrorMessage(Ret)        Ret = MsgBox("CameraType =" & Str(CamType), vbInformation, "DCGetNativeCameraType")End SubPrivate Sub Menu53_Click()    Dim Ret As Integer    Dim TempStr As String, Cnt As Integer    Dim ThumbImage() As Byte    Dim ThumbFlag As Integer    Dim Cnt1 As Integer, Cnt2 As Integer    Dim TIFFEPBuf() As Byte    Dim TIFFEPSize As Long    Dim TIFFEPFileName As String    Dim FileNum As Integer    Dim ThumbWidth As Integer, ThumbHeight As Integer    Dim Angle As Long        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        CommonDialog1.filename = ""    CommonDialog1.Filter = "DC40/50/120 Pictures (*.kdc)|*.kdc|All Files (*.*)|*.*"    CommonDialog1.ShowOpen        If CommonDialog1.filename = "" Then        Exit Sub    Else        TIFFEPFileName = CommonDialog1.filename    End If           FileNum = FreeFile    Open TIFFEPFileName For Binary Access Read As FileNum    TIFFEPSize = LOF(FileNum)        If TIFFEPSize = 0 Then        StatusBar1.SimpleText = "DCGetNativePictInfo:FileNotFound"        Close FileNum        Kill TIFFEPFileName        Exit Sub    Else        ReDim TIFFEPBuf(TIFFEPSize)        Get FileNum, , TIFFEPBuf        Close FileNum    End If        Form1.StatusBar1.SimpleText = "Now Calling DCGetNativeCameraType..."    Form1.Refresh        Ret = DCGetNativeCameraType(CameraData, TIFFEPSize, TIFFEPBuf(0), CamType)    StatusBar1.SimpleText = "DCGetNativeCameraType:" & DCMakeErrorMessage(Ret)        If Ret < DC_NoErr Then        GoTo EndLine    End If       If Check1.Value = 1 Then'+b1c1 changed'       Select Case CameraData.Driver.GenericCameraType        Select Case CameraData.Driver.SpecificCamType'-b1c1 changed        Case DC40            ReDim ThumbImage(DC40ThumbSize)        Case DC50            ReDim ThumbImage(DC50ThumbSize)        Case DC120            ReDim ThumbImage(DC120ThumbSize)        End Select        ThumbFlag = True    Else        ReDim ThumbImage(1)        ThumbFlag = False    End If        Form1.StatusBar1.SimpleText = "Now Calling DCGetNativePictInfo..."    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType'-b1c1 changed    Case DC40        Ret = DCGetNativePictInfo(CameraData, TIFFEPSize, TIFFEPBuf(0), ThumbFlag, ThumbImage(0), GenericPictInfo, FullDC40PictInfo)    Case DC50        Ret = DCGetNativePictInfo(CameraData, TIFFEPSize, TIFFEPBuf(0), ThumbFlag, ThumbImage(0), GenericPictInfo, FullDC50PictInfo)    Case DC120        Ret = DCGetNativePictInfo(CameraData, TIFFEPSize, TIFFEPBuf(0), ThumbFlag, ThumbImage(0), GenericPictInfo, FullDC120PictInfo)    End Select    StatusBar1.SimpleText = "DCGetNativePictInfo:" & DCMakeErrorMessage(Ret)            If Ret = DC_NoErr Then        Load Form3        Form3.Caption = "DCGetNativePictInfo"        Form3.List1.Clear        Form3.Picture1.Visible = True                SetGenericPictInfoToList       '+b1c1 changed'       Select Case CameraData.Driver.GenericCameraType        Select Case CameraData.Driver.SpecificCamType'-b1c1 changed        Case DC40            SetDC40PictInfoToList        Case DC50            SetDC50PictInfoToList        Case DC120            SetDC120PictInfoToList        End Select            Form3.Show                If IPData.RotateFlag Then            Angle = IPData.RotateAngle        Else            Angle = DCRotate0        End If        If Angle = DCUsePictOrientation Then'+b1c1 changed'           Select Case CameraData.Driver.GenericCameraType            Select Case CameraData.Driver.SpecificCamType'-b1c1 changed            Case DC40                Angle = FullDC40PictInfo.PictOrientation            Case DC50                Angle = FullDC50PictInfo.PictOrientation            Case DC120                Angle = FullDC120PictInfo.PictOrientation            End Select        End If        Select Case Angle        Case DCRotate0            ThumbWidth = GenericPictInfo.ThumbWidth            ThumbHeight = GenericPictInfo.ThumbHeight        Case DCRotate180            ThumbWidth = GenericPictInfo.ThumbWidth            ThumbHeight = GenericPictInfo.ThumbHeight        Case DCRotate90            ThumbWidth = GenericPictInfo.ThumbHeight            ThumbHeight = GenericPictInfo.ThumbWidth        Case DCRotate270            ThumbWidth = GenericPictInfo.ThumbHeight            ThumbHeight = GenericPictInfo.ThumbWidth        End Select        If Check1.Value = 1 Then            For Cnt1 = (ThumbHeight - 1) To 0 Step -1                For Cnt2 = 0 To (ThumbWidth * 3 - 1) Step 3                    Form3.Picture1.PSet (Cnt2 / 3, ThumbHeight - 1 - Cnt1), RGB(CInt(ThumbImage(Cnt1 * ThumbWidth * 3 + Cnt2 + 2)), CInt(ThumbImage(Cnt1 * ThumbWidth * 3 + Cnt2 + 1)), ThumbImage(CInt(Cnt1 * ThumbWidth * 3 + Cnt2)))                Next Cnt2            Next Cnt1        End If                    End IfEndLine:End SubPrivate Sub Menu54_Click()    Dim Ret As Integer    Dim TempStr As String, Cnt As Integer    Dim ThumbImage(1) As Byte    Dim ThumbFlag As Integer    Dim Cnt1 As Integer, Cnt2 As Integer    Dim InputSize As Long, OutputSize As Long    Dim InputBuf() As Byte, OutputBuf() As Byte    Dim PictWidth As Long, PictHeight As Long        'Added declarations    Dim BMPInfoHeader As BITMAPINFOHEADER    Dim BMPFileHeader As BITMAPFILEHEADER    Dim BitMapFileNum As Integer        CamMemType = Val(Text2.Text)    AlbumNum = Val(Text3.Text)    PictNum = Val(Text1.Text)        Form1.StatusBar1.SimpleText = "Now Calling DCGetCameraPictInfo..."    Form1.Refresh    '+b1c1 changed'    Select Case CameraData.Driver.GenericCameraType    Select Case CameraData.Driver.SpecificCamType'-b1c1 changed    Case DC40        Ret = DCGetCameraPictInfo(CameraData, CamMemType, AlbumNum, PictNum, False, ThumbImage(0), GenericPictInfo, FullDC40PictInfo)    Case DC50        Ret = DCGetCameraPictInfo(CameraData, CamMemType, AlbumNum, PictNum, False, ThumbImage(0), GenericPictInfo, FullDC50PictInfo)    Case DC120        Ret = DCGetCameraPictInfo(CameraData, CamMemType, AlbumNum, PictNum, False, ThumbImage(0), GenericPictInfo, FullDC120PictInfo)    End Select    StatusBar1.SimpleText = "DCGetCameraPictInfo:" & DCMakeErrorMessage(Ret)        If Ret < DC_NoErr Then        GoTo EndLine    End If        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        InputSize = GenericPictInfo.PictMinBufIn    OutputSize = GenericPictInfo.PictWidth * GenericPictInfo.PictHeight * 3            ReDim InputBuf(InputSize)    ReDim OutputBuf(OutputSize)            Form1.StatusBar1.SimpleText = "Now Calling DCGetCameraPicture..."    Form1.Refresh        Ret = DCGetCameraPicture(CameraData, CamMemType, AlbumNum, GenericPictInfo, InputSize, InputBuf(0), OutputSize, OutputBuf(0))    StatusBar1.SimpleText = "DCGetCameraPicture:" & DCMakeErrorMessage(Ret)                If Ret = DC_NoErr Then        'New Version        With BMPInfoHeader            .biSize = 40            .biWidth = GenericPictInfo.PictWidth            .biHeight = GenericPictInfo.PictHeight            .biPlanes = 1            .biBitCount = 24            .biCompression = BI_RGB            .biSizeImage = 0            .biXPelsPerMeter = 0            .biYPelsPerMeter = 0            .biClrUsed = 0            .biClrImportant = 0        End With        With BMPFileHeader            .bfType = &H4D42            .bfSize = OutputSize + 54            .bfReserved1 = 0            .bfReserved2 = 0            .bfOffBits = 54        End With                    TempBMPFileName = CurDir & "\TempFile.bmp"        BitMapFileNum = FreeFile        Open TempBMPFileName For Binary Access Write As BitMapFileNum        Put BitMapFileNum, , BMPFileHeader        Put BitMapFileNum, , BMPInfoHeader        Put BitMapFileNum, , OutputBuf        Close BitMapFileNum                    Load Form5        Form5.Picture1.Picture = LoadPicture(TempBMPFileName)        Form5.Show                End IfEndLine:End SubPrivate Sub Menu55_Click()    Dim Ret As Integer    Dim PictNum As Integer    Dim ThumbImage(1) As Byte'+1.03 changed    Dim TIFFEPFileName As String    Dim hfile_dest As Long    Dim Lx As Long    Dim sts As Long'-1.03 changed'    Dim OutputSize As Long, OutputBuf() As Byte        CamMemType = Val(Text2.Text)    AlbumNum = Val(Text3.Text)    PictNum = Val(Text1.Text)        Form1.StatusBar1.SimpleText = "Now Calling DCGetCameraPictInfo..."    Form1.Refresh        Select Case CameraData.Driver.SpecificCamType    Case DC40        Ret = DCGetCameraPictInfo(CameraData, CamMemType, AlbumNum, PictNum, False, ThumbImage(0), GenericPictInfo, FullDC40PictInfo)    Case DC50        Ret = DCGetCameraPictInfo(CameraData, CamMemType, AlbumNum, PictNum, False, ThumbImage(0), GenericPictInfo, FullDC50PictInfo)    Case DC120        Ret = DCGetCameraPictInfo(CameraData, CamMemType, AlbumNum, PictNum, False, ThumbImage(0), GenericPictInfo, FullDC120PictInfo)    End Select    StatusBar1.SimpleText = "DCGetCameraPictInfo:" & DCMakeErrorMessage(Ret)        If Ret < DC_NoErr Then        GoTo EndLine    End If        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        TIFFEPSize = GenericPictInfo.PictCompSize    ReDim TIFFEPBuf(TIFFEPSize)            Form1.StatusBar1.SimpleText = "Now Calling DCGetNativePicture..."    Form1.Refresh        Ret = DCGetNativePicture(CameraData, CamMemType, AlbumNum, GenericPictInfo, TIFFEPSize, TIFFEPBuf(0))            StatusBar1.SimpleText = "DCGetNativePicture:" & DCMakeErrorMessage(Ret)    'start'    OutputSize = GenericPictInfo.PictWidth * GenericPictInfo.PictHeight * 3'    ReDim OutputBuf(OutputSize)'    Form1.StatusBar1.SimpleText = "Now Calling DCProcNativePicture..."'    Form1.Refresh    '    Ret = DCProcNativePicture(CameraData, GenericPictInfo, TIFFEPSize, TIFFEPBuf(0), OutputSize, OutputBuf(0))'    StatusBar1.SimpleText = "DCProcNativePicture:" & DCMakeErrorMessage(Ret)'end    If Ret = DC_NoErr Then        CommonDialog1.filename = ""        CommonDialog1.Filter = "DC40/50/120 Pictures (*.kdc)|*.kdc|All Files (*.*)|*.*"        CommonDialog1.ShowSave        If CommonDialog1.filename = "" Then            Exit Sub        Else            TIFFEPFileName = CommonDialog1.filename        End If    '+1.03 changed        hfile_dest = lcreat(TIFFEPFileName, 0)        ReDim Preserve TIFFEPBuf(TIFFEPSize)        Lx = hwrite(hfile_dest, TIFFEPBuf(0), TIFFEPSize)        sts = lclose(hfile_dest)        '        TIFFEPFileNum = FreeFile'        Open TIFFEPFileName For Binary Access Write As TIFFEPFileNum'        ReDim Preserve TIFFEPBuf(TIFFEPSize)'        Put TIFFEPFileNum, , TIFFEPBuf'        Close TIFFEPFileNum'-1.03 changed    End IfEndLine:End SubPrivate Sub Menu56_Click()    Dim Ret As Integer    Dim PictNum As Integer    Dim TempStr As String, Cnt As Integer    Dim ThumbImage(1) As Byte    Dim ThumbFlag As Integer    Dim Cnt1 As Integer, Cnt2 As Integer    Dim InputSize As Long, InputBuf() As Byte    Dim OutputSize As Long, OutputBuf() As Byte    Dim PictWidth As Long, PictHeight As Long    Dim TIFFEPFileName As String    Dim FileNum As Integer        'Added declarations    Dim BMPInfoHeader As BITMAPINFOHEADER    Dim BMPFileHeader As BITMAPFILEHEADER    Dim BitMapFileNum As Integer        Form1.StatusBar1.SimpleText = ""    Form1.Refresh        CommonDialog1.filename = ""    CommonDialog1.Filter = "DC40/50/120 Pictures (*.kdc)|*.kdc|All Files (*.*)|*.*"    CommonDialog1.ShowOpen        If CommonDialog1.filename = "" Then        Exit Sub    Else        TIFFEPFileName = CommonDialog1.filename    End If           FileNum = FreeFile    Open TIFFEPFileName For Binary Access Read As FileNum    TIFFEPSize = LOF(FileNum)        If TIFFEPSize = 0 Then        StatusBar1.SimpleText = "DCProcNativePicture:FileNotFound"        Close FileNum        Kill TIFFEPFileName        Exit Sub    Else        ReDim TIFFEPBuf(TIFFEPSize)        Get FileNum, , TIFFEPBuf        Close FileNum    End If            Form1.StatusBar1.SimpleText = "Now Calling DCGetNativeCameraType..."    Form1.Refresh        Ret = DCGetNativeCameraType(CameraData, TIFFEPSize, TIFFEPBuf(0), CamType)    StatusBar1.SimpleText = "DCGetNativeCameraType:" & DCMakeErrorMessage(Ret)        If Ret < DC_NoErr Then        GoTo EndLine    End If        Form1.StatusBar1.SimpleText = "Now Calling DCGetNativePictInfo..."    Form1.Refresh        Select Case CamType    Case DC40        Ret = DCGetNativePictInfo(CameraData, TIFFEPSize, TIFFEPBuf(0), False, ThumbImage(0), GenericPictInfo, FullDC40PictInfo)    Case DC50        Ret = DCGetNativePictInfo(CameraData, TIFFEPSize, TIFFEPBuf(0), False, ThumbImage(0), GenericPictInfo, FullDC50PictInfo)    Case DC120        Ret = DCGetNativePictInfo(CameraData, TIFFEPSize, TIFFEPBuf(0), False, ThumbImage(0), GenericPictInfo, FullDC120PictInfo)    End Select    StatusBar1.SimpleText = "DCGetNativePictInfo:" & DCMakeErrorMessage(Ret)            If Ret < DC_NoErr Then        GoTo EndLine    End If        OutputSize = GenericPictInfo.PictWidth * GenericPictInfo.PictHeight * 3    ReDim OutputBuf(OutputSize)                Form1.StatusBar1.SimpleText = "Now Calling DCProcNativePicture..."    Form1.Refresh        Ret = DCProcNativePicture(CameraData, GenericPictInfo, TIFFEPSize, TIFFEPBuf(0), OutputSize, OutputBuf(0))    StatusBar1.SimpleText = "DCProcNativePicture:" & DCMakeErrorMessage(Ret)               'New Version    With BMPInfoHeader        .biSize = 40        .biWidth = GenericPictInfo.PictWidth        .biHeight = GenericPictInfo.PictHeight        .biPlanes = 1        .biBitCount = 24        .biCompression = BI_RGB        .biSizeImage = 0        .biXPelsPerMeter = 0        .biYPelsPerMeter = 0        .biClrUsed = 0        .biClrImportant = 0    End With    With BMPFileHeader        .bfType = &H4D42        .bfSize = OutputSize + 54        .bfReserved1 = 0        .bfReserved2 = 0        .bfOffBits = 54    End With                TempBMPFileName = CurDir & "\TempFile.bmp"    BitMapFileNum = FreeFile    Open TempBMPFileName For Binary Access Write As BitMapFileNum    Put BitMapFileNum, , BMPFileHeader    Put BitMapFileNum, , BMPInfoHeader    Put BitMapFileNum, , OutputBuf    Close BitMapFileNum                Load Form5    Form5.Picture1.Picture = LoadPicture(TempBMPFileName)    Form5.Show            EndLine: End SubPublic Sub SetGenericPictInfoToList()        Form3.List1.AddItem "- GenericPictInfo -"        Form3.List1.AddItem "PictNumber         : " & GenericPictInfo.PictNumber        Form3.List1.AddItem "ThumbWidht         : " & GenericPictInfo.ThumbWidth        Form3.List1.AddItem "ThumbHight         : " & GenericPictInfo.ThumbHeight        Form3.List1.AddItem "PictWidth          : " & GenericPictInfo.PictWidth        Form3.List1.AddItem "PictHeight         : " & GenericPictInfo.PictHeight        Form3.List1.AddItem "PictCompSize       : " & GenericPictInfo.PictCompSize        Form3.List1.AddItem "PictMinBufIn       : " & GenericPictInfo.PictMinBufIn        Form3.List1.AddItem "PictMinbufOut      : " & GenericPictInfo.PictMinBufOut        Form3.List1.AddItem "TimeStamp tm_year  : " & GenericPictInfo.TimeStamp.tm_year        Form3.List1.AddItem "          tm_mon   : " & GenericPictInfo.TimeStamp.tm_mon        Form3.List1.AddItem "          tm_mday  : " & GenericPictInfo.TimeStamp.tm_mday        Form3.List1.AddItem "          tm_hour  : " & GenericPictInfo.TimeStamp.tm_hour        Form3.List1.AddItem "          tm_min   : " & GenericPictInfo.TimeStamp.tm_min        Form3.List1.AddItem "          tm_sec   : " & GenericPictInfo.TimeStamp.tm_sec        Form3.List1.AddItem "          tm_wday  : " & GenericPictInfo.TimeStamp.tm_wday        Form3.List1.AddItem "          tm_yday  : " & GenericPictInfo.TimeStamp.tm_yday        Form3.List1.AddItem "          tm_isdst : " & GenericPictInfo.TimeStamp.tm_isdst        End SubPublic Sub SetDC40PictInfoToList()    Form3.List1.AddItem "- FullPictInfo(DC40PictInfo) -"    Form3.List1.AddItem "ExposureTime    : " & FullDC40PictInfo.ExposureTime    Form3.List1.AddItem "FlashUsed       : " & FullDC40PictInfo.FlashUsed    Form3.List1.AddItem "FNumber         : " & FullDC40PictInfo.FNumber    Form3.List1.AddItem "PictOrientation : " & FullDC40PictInfo.PictOrientationEnd SubPublic Sub SetDC50PictInfoToList()    Dim Cnt As Integer    Dim TempStr As String        Form3.List1.AddItem "- FullPictInfo(DC50PictInfo) -"    Form3.List1.AddItem "TimerMode       : " & FullDC50PictInfo.TimerMode    Form3.List1.AddItem "FlashUsed       : " & FullDC50PictInfo.FlashUsed    Form3.List1.AddItem "FlashMode       : " & FullDC50PictInfo.FlashMode    Form3.List1.AddItem "PictQuality     : " & FullDC50PictInfo.PictQuality    Form3.List1.AddItem "ZoomPosition    : " & FullDC50PictInfo.ZoomPosition    Form3.List1.AddItem "ManualExpFlag   : " & FullDC50PictInfo.ManualExpFlag    Form3.List1.AddItem "ExposureTime    : " & FullDC50PictInfo.ExposureTime    Form3.List1.AddItem "FNumber         : " & FullDC50PictInfo.FNumber    Form3.List1.AddItem "BatteryLevel    : " & FullDC50PictInfo.BatteryLevel    Form3.List1.AddItem "PictOrientation : " & FullDC50PictInfo.PictOrientation    Form3.List1.AddItem "ProgramUsed     : " & FullDC50PictInfo.ProgramUsed    Form3.List1.AddItem "FocusMode       : " & FullDC50PictInfo.FocusMode    Form3.List1.AddItem "FocusPosition   : " & FullDC50PictInfo.FocusPosition    Form3.List1.AddItem "LightValue      : " & FullDC50PictInfo.LightValue    Form3.List1.AddItem "ExposureValue   : " & FullDC50PictInfo.ExposureValue    Form3.List1.AddItem "AVData          : " & FullDC50PictInfo.AVData    For Cnt = 0 To 8        TempStr = TempStr & Chr(FullDC50PictInfo.ImageName(Cnt))    Next Cnt    Form3.List1.AddItem "ImageName       : " & TempStrEnd SubPublic Sub SetDC120PictInfoToList()    Dim Cnt As Integer    Dim TempStr As String        Form3.List1.AddItem "- FullPictInfo(DC120PictInfo) -"    Form3.List1.AddItem "TimerMode       : " & FullDC120PictInfo.TimerMode    Form3.List1.AddItem "FlashUsed       : " & FullDC120PictInfo.FlashUsed    Form3.List1.AddItem "FlashMode       : " & FullDC120PictInfo.FlashMode    Form3.List1.AddItem "PictQuality     : " & FullDC120PictInfo.PictQuality    Form3.List1.AddItem "ZoomPosition    : " & FullDC120PictInfo.ZoomPosition    Form3.List1.AddItem "ManualExpFlag   : " & FullDC120PictInfo.ManualExpFlag    Form3.List1.AddItem "ExposureTime    : " & FullDC120PictInfo.ExposureTime    Form3.List1.AddItem "FNumber         : " & FullDC120PictInfo.FNumber    Form3.List1.AddItem "BatteryLevel    : " & FullDC120PictInfo.BatteryLevel    Form3.List1.AddItem "PictOrientation : " & FullDC120PictInfo.PictOrientation    Form3.List1.AddItem "FocusMode       : " & FullDC120PictInfo.FocusMode    Form3.List1.AddItem "FocusPosition   : " & FullDC120PictInfo.FocusPosition    Form3.List1.AddItem "LightValue      : " & FullDC120PictInfo.LightValue    Form3.List1.AddItem "WBAuto        WBGainR : " & FullDC120PictInfo.WBAuto.WBGainR    Form3.List1.AddItem "              WBGainG : " & FullDC120PictInfo.WBAuto.WBGainG    Form3.List1.AddItem "              WBGainB : " & FullDC120PictInfo.WBAuto.WBGainB    Form3.List1.AddItem "WBDayLight    WBGainR : " & FullDC120PictInfo.WBDayLight.WBGainR    Form3.List1.AddItem "              WBGainG : " & FullDC120PictInfo.WBDayLight.WBGainG    Form3.List1.AddItem "              WBGainB : " & FullDC120PictInfo.WBDayLight.WBGainB    Form3.List1.AddItem "WBIndoor      WBGainR : " & FullDC120PictInfo.WBIndoor.WBGainR    Form3.List1.AddItem "              WBGainG : " & FullDC120PictInfo.WBIndoor.WBGainG    Form3.List1.AddItem "              WBGainB : " & FullDC120PictInfo.WBIndoor.WBGainB    Form3.List1.AddItem "WBFluorescent WBGainR : " & FullDC120PictInfo.WBFluorescent.WBGainR    Form3.List1.AddItem "              WBGainG : " & FullDC120PictInfo.WBFluorescent.WBGainG    Form3.List1.AddItem "              WBGainB : " & FullDC120PictInfo.WBFluorescent.WBGainB    For Cnt = 0 To 8        TempStr = TempStr & Chr(FullDC120PictInfo.ImageName(Cnt))    Next Cnt    Form3.List1.AddItem "ImageName             : " & TempStrEnd Sub